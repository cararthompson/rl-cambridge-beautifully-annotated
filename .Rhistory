title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>** was associated with greater mean tooth growth, compared to equivalent doses of Vitamin C"),
subtitle = "With the highest dose, the mean recorded lendth was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(#legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(hjust = 0.5),
text = element_text(family = "Cabin"),
plot.title = ggtext::element_textbox_simple(family = "Enriqueta", size = 16, lineheight = 1.3,
margin = margin(0.5, 0, 1, 0, "lines"),
halign = 0),
plot.subtitle = ggtext::element_textbox_simple(family = "Cabin", size = 12, lineheight = 1.3,
margin = margin(0, 0, 1, 0, "lines"),
halign = 0),
strip.text = element_text(family = "Arvo", face = "bold",
size = 12, margin = margin(2, 0, 0.5, 0, "lines")))
ToothGrowth %>%
mutate(supplement = case_when(supp == "OJ" ~ "Orange Juice",
supp == "VC" ~ "Vitamin C",
TRUE ~ as.character(supp))) %>%
group_by(supplement, dose) %>%
summarise(mean_length = mean(len)) %>%
mutate(categorical_dose = factor(dose)) %>%
ggplot(aes(x = categorical_dose,
y = mean_length,
fill = supplement)) +
geom_bar(aes(alpha = dose),
stat = "identity",
position = "dodge",
colour = "#FFFFFF", #
size = 2) + #
scale_alpha(range = c(0.33, 1)) + #
coord_flip() + #
theme_minimal() +
facet_wrap(supplement ~ ., ncol = 1) +
ggtext::geom_textbox(aes(
x = categorical_dose,
y = mean_length,
label = paste0("<span style=font-size:9pt>", dose, "mg/day</span><br>", mean_length, "mm"),
hjust = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
halign = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
colour = case_when(mean_length > 15 ~ "#FFFFFF",
TRUE ~ vit_c_palette[supplement])
),
fill = NA,
fontface = "bold",
box.colour = NA,
family = "Segoe UI") +
scale_colour_identity() +
scale_fill_manual(values = vit_c_palette) +
labs(y = "Mean length of odontobast cells",
title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>** was associated with greater mean tooth growth, compared to equivalent doses of Vitamin C"),
subtitle = "With the highest dose, the mean recorded lendth was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(#legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(hjust = 0.5),
text = element_text(family = "Cabin"),
plot.title = ggtext::element_textbox_simple(family = "Enriqueta", size = 16, lineheight = 1.3,
margin = margin(0.5, 0, 1, 0, "lines"),
halign = 0),
plot.subtitle = ggtext::element_textbox_simple(family = "Cabin", size = 12, lineheight = 1.3,
margin = margin(0, 0, 1, 0, "lines"),
halign = 0),
strip.text = element_text(family = "Enriqueta", face = "bold",
size = 12, margin = margin(2, 0, 0.5, 0, "lines")))
ToothGrowth %>%
mutate(supplement = case_when(supp == "OJ" ~ "Orange Juice",
supp == "VC" ~ "Vitamin C",
TRUE ~ as.character(supp))) %>%
group_by(supplement, dose) %>%
summarise(mean_length = mean(len)) %>%
mutate(categorical_dose = factor(dose)) %>%
ggplot(aes(x = categorical_dose,
y = mean_length,
fill = supplement)) +
geom_bar(aes(alpha = dose),
stat = "identity",
position = "dodge",
colour = "#FFFFFF", #
size = 2) + #
scale_alpha(range = c(0.33, 1)) + #
coord_flip() + #
theme_minimal() +
facet_wrap(supplement ~ ., ncol = 1) +
ggtext::geom_textbox(aes(
x = categorical_dose,
y = mean_length,
label = paste0("<span style=font-size:9pt>", dose, "mg/day</span><br>", mean_length, "mm"),
hjust = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
halign = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
colour = case_when(mean_length > 15 ~ "#FFFFFF",
TRUE ~ vit_c_palette[supplement])
),
fill = NA,
fontface = "bold",
box.colour = NA,
family = "Segoe UI") +
scale_colour_identity() +
scale_fill_manual(values = vit_c_palette) +
labs(y = "Mean length of odontobast cells",
title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>** was associated with greater mean tooth growth, compared to equivalent doses of Vitamin C"),
subtitle = "With the highest dose, the mean recorded lendth was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(#legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(hjust = 0.5),
text = element_text(family = "Segoe UI"),
plot.title = ggtext::element_textbox_simple(family = "Enriqueta", size = 16, lineheight = 1.3,
margin = margin(0.5, 0, 1, 0, "lines"),
halign = 0),
plot.subtitle = ggtext::element_textbox_simple(family = "Cabin", size = 12, lineheight = 1.3,
margin = margin(0, 0, 1, 0, "lines"),
halign = 0),
strip.text = element_text(family = "Enriqueta", face = "bold",
size = 12, margin = margin(2, 0, 0.5, 0, "lines")))
ToothGrowth %>%
mutate(supplement = case_when(supp == "OJ" ~ "Orange Juice",
supp == "VC" ~ "Vitamin C",
TRUE ~ as.character(supp))) %>%
group_by(supplement, dose) %>%
summarise(mean_length = mean(len)) %>%
mutate(categorical_dose = factor(dose)) %>%
ggplot(aes(x = categorical_dose,
y = mean_length,
fill = supplement)) +
geom_bar(aes(alpha = dose),
stat = "identity",
position = "dodge",
colour = "#FFFFFF", #
size = 2) + #
scale_alpha(range = c(0.33, 1)) + #
coord_flip() + #
theme_minimal() +
facet_wrap(supplement ~ ., ncol = 1) +
ggtext::geom_textbox(aes(
x = categorical_dose,
y = mean_length,
label = paste0("<span style=font-size:9pt>", dose, "mg/day</span><br>", mean_length, "mm"),
hjust = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
halign = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
colour = case_when(mean_length > 15 ~ "#FFFFFF",
TRUE ~ vit_c_palette[supplement])
),
fill = NA,
fontface = "bold",
box.colour = NA,
family = "Segoe UI") +
scale_colour_identity() +
scale_fill_manual(values = vit_c_palette) +
labs(y = "Mean length of odontobast cells",
title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>** was associated with greater mean tooth growth, compared to equivalent doses of Vitamin C"),
subtitle = "With the highest dose, the mean recorded length was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(#legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(hjust = 0.5),
text = element_text(family = "Segoe UI"),
plot.title = ggtext::element_textbox_simple(family = "Enriqueta", size = 16, lineheight = 1.3,
margin = margin(0.5, 0, 1, 0, "lines"),
halign = 0),
plot.subtitle = ggtext::element_textbox_simple(family = "Cabin", size = 12, lineheight = 1.3,
margin = margin(0, 0, 1, 0, "lines"),
halign = 0),
strip.text = element_text(family = "Enriqueta", face = "bold",
size = 12, margin = margin(2, 0, 0.5, 0, "lines")))
ToothGrowth %>%
mutate(supplement = case_when(supp == "OJ" ~ "Orange Juice",
supp == "VC" ~ "Vitamin C",
TRUE ~ as.character(supp))) %>%
group_by(supplement, dose) %>%
summarise(mean_length = mean(len)) %>%
mutate(categorical_dose = factor(dose)) %>%
ggplot(aes(x = categorical_dose,
y = mean_length,
fill = supplement)) +
geom_bar(aes(alpha = dose),
stat = "identity",
position = "dodge",
colour = "#FFFFFF", #
size = 2) + #
scale_alpha(range = c(0.33, 1)) + #
coord_flip() + #
theme_minimal() +
facet_wrap(supplement ~ ., ncol = 1) +
ggtext::geom_textbox(aes(
x = categorical_dose,
y = mean_length,
label = paste0("<span style=font-size:9pt>", dose, "mg/day</span><br>", mean_length, "mm"),
hjust = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
halign = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
colour = case_when(mean_length > 15 ~ "#FFFFFF",
TRUE ~ vit_c_palette[supplement])
),
fill = NA,
fontface = "bold",
box.colour = NA,
family = "Segoe UI") +
scale_colour_identity() +
scale_fill_manual(values = vit_c_palette) +
labs(y = "Mean length of odontobast cells",
title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>** was associated with greater mean tooth growth, compared to equivalent doses of Vitamin C"),
subtitle = "With the highest dose, the mean recorded length was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(hjust = 0.5),
text = element_text(family = "Segoe UI"),
plot.title = ggtext::element_textbox_simple(family = "Enriqueta", size = 16, lineheight = 1.3,
margin = margin(0.5, 0, 1, 0, "lines"),
halign = 0),
plot.subtitle = ggtext::element_textbox_simple(family = "Cabin", size = 12, lineheight = 1.3,
margin = margin(0, 0, 1, 0, "lines"),
halign = 0),
strip.text = element_text(family = "Enriqueta", face = "bold",
size = 12, margin = margin(2, 0, 0.5, 0, "lines")))
vit_c_palette <- c("Vitamin C" = "#ea5905",
"Orange Juice" = "#fbc81d",
light_text = "grey50",
dark_text = "grey20")
ToothGrowth %>%
mutate(supplement = case_when(supp == "OJ" ~ "Orange Juice",
supp == "VC" ~ "Vitamin C",
TRUE ~ as.character(supp))) %>%
group_by(supplement, dose) %>%
summarise(mean_length = mean(len)) %>%
mutate(categorical_dose = factor(dose)) %>%
ggplot(aes(x = categorical_dose,
y = mean_length,
fill = supplement)) +
geom_bar(aes(alpha = dose),
stat = "identity",
position = "dodge",
colour = "#FFFFFF", #
size = 2) + #
scale_alpha(range = c(0.33, 1)) + #
coord_flip() + #
theme_minimal() +
facet_wrap(supplement ~ ., ncol = 1) +
ggtext::geom_textbox(aes(
x = categorical_dose,
y = mean_length,
label = paste0("<span style=font-size:9pt>", dose, "mg/day</span><br>", mean_length, "mm"),
hjust = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
halign = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
colour = case_when(mean_length > 15 ~ "#FFFFFF",
TRUE ~ vit_c_palette[supplement])
),
fill = NA,
fontface = "bold",
box.colour = NA,
family = "Segoe UI") +
scale_colour_identity() +
scale_fill_manual(values = vit_c_palette) +
labs(y = "Mean length of odontobast cells",
title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>** was associated with greater mean tooth growth, compared to equivalent doses of Vitamin C"),
subtitle = "With the highest dose, the mean recorded length was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(hjust = 0.5),
text = element_text(family = "Segoe UI"),
plot.title = ggtext::element_textbox_simple(family = "Enriqueta", size = 16, lineheight = 1.3,
margin = margin(0.5, 0, 1, 0, "lines"),
halign = 0),
plot.subtitle = ggtext::element_textbox_simple(family = "Cabin", size = 12, lineheight = 1.3,
margin = margin(0, 0, 1, 0, "lines"),
halign = 0),
strip.text = element_text(family = "Enriqueta", face = "bold",
size = 12, margin = margin(2, 0, 0.5, 0, "lines")))
vit_c_palette <- c("Vitamin C" = "#ea5905",
"Orange Juice" = "#ecb31e",
light_text = "grey50",
dark_text = "grey20")
ToothGrowth %>%
mutate(supplement = case_when(supp == "OJ" ~ "Orange Juice",
supp == "VC" ~ "Vitamin C",
TRUE ~ as.character(supp))) %>%
group_by(supplement, dose) %>%
summarise(mean_length = mean(len)) %>%
mutate(categorical_dose = factor(dose)) %>%
ggplot(aes(x = categorical_dose,
y = mean_length,
fill = supplement)) +
geom_bar(aes(alpha = dose),
stat = "identity",
position = "dodge",
colour = "#FFFFFF", #
size = 2) + #
scale_alpha(range = c(0.33, 1)) + #
coord_flip() + #
theme_minimal() +
facet_wrap(supplement ~ ., ncol = 1) +
ggtext::geom_textbox(aes(
x = categorical_dose,
y = mean_length,
label = paste0("<span style=font-size:9pt>", dose, "mg/day</span><br>", mean_length, "mm"),
hjust = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
halign = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
colour = case_when(mean_length > 15 ~ "#FFFFFF",
TRUE ~ vit_c_palette[supplement])
),
fill = NA,
fontface = "bold",
box.colour = NA,
family = "Segoe UI") +
scale_colour_identity() +
scale_fill_manual(values = vit_c_palette) +
labs(y = "Mean length of odontobast cells",
title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>** was associated with greater mean tooth growth, compared to equivalent doses of Vitamin C"),
subtitle = "With the highest dose, the mean recorded length was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(hjust = 0.5),
text = element_text(family = "Segoe UI"),
plot.title = ggtext::element_textbox_simple(family = "Enriqueta", size = 16, lineheight = 1.3,
margin = margin(0.5, 0, 1, 0, "lines"),
halign = 0),
plot.subtitle = ggtext::element_textbox_simple(family = "Cabin", size = 12, lineheight = 1.3,
margin = margin(0, 0, 1, 0, "lines"),
halign = 0),
strip.text = element_text(family = "Enriqueta", face = "bold",
size = 12, margin = margin(2, 0, 0.5, 0, "lines")))
plot <- ToothGrowth %>%
mutate(supplement = case_when(supp == "OJ" ~ "Orange Juice",
supp == "VC" ~ "Vitamin C",
TRUE ~ as.character(supp))) %>%
group_by(supplement, dose) %>%
summarise(mean_length = mean(len)) %>%
mutate(categorical_dose = factor(dose)) %>%
ggplot(aes(x = categorical_dose,
y = mean_length,
fill = supplement)) +
geom_bar(aes(alpha = dose),
stat = "identity",
position = "dodge",
colour = "#FFFFFF", #
size = 2) + #
scale_alpha(range = c(0.33, 1)) + #
coord_flip() + #
theme_minimal() +
facet_wrap(supplement ~ ., ncol = 1) +
ggtext::geom_textbox(aes(
x = categorical_dose,
y = mean_length,
label = paste0("<span style=font-size:9pt>", dose, "mg/day</span><br>", mean_length, "mm"),
hjust = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
halign = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
colour = case_when(mean_length > 15 ~ "#FFFFFF",
TRUE ~ vit_c_palette[supplement])
),
fill = NA,
fontface = "bold",
box.colour = NA,
family = "Segoe UI") +
scale_colour_identity() +
scale_fill_manual(values = vit_c_palette) +
labs(y = "Mean length of odontobast cells",
title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>** was associated with greater mean tooth growth, compared to equivalent doses of Vitamin C"),
subtitle = "With the highest dose, the mean recorded length was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(hjust = 0.5),
text = element_text(family = "Segoe UI"),
plot.title = element_markdown(family = "Enriqueta", size = 16, lineheight = 1.3,
margin = margin(0.5, 0, 1, 0, "lines"),
halign = 0),
plot.subtitle = element_markdown(family = "Cabin", size = 12, lineheight = 1.3,
margin = margin(0, 0, 1, 0, "lines"),
halign = 0),
strip.text = element_text(family = "Enriqueta", face = "bold",
size = 12, margin = margin(2, 0, 0.5, 0, "lines")))
plot <- ToothGrowth %>%
mutate(supplement = case_when(supp == "OJ" ~ "Orange Juice",
supp == "VC" ~ "Vitamin C",
TRUE ~ as.character(supp))) %>%
group_by(supplement, dose) %>%
summarise(mean_length = mean(len)) %>%
mutate(categorical_dose = factor(dose)) %>%
ggplot(aes(x = categorical_dose,
y = mean_length,
fill = supplement)) +
geom_bar(aes(alpha = dose),
stat = "identity",
position = "dodge",
colour = "#FFFFFF", #
size = 2) + #
scale_alpha(range = c(0.33, 1)) + #
coord_flip() + #
theme_minimal() +
facet_wrap(supplement ~ ., ncol = 1) +
ggtext::geom_textbox(aes(
x = categorical_dose,
y = mean_length,
label = paste0("<span style=font-size:9pt>", dose, "mg/day</span><br>", mean_length, "mm"),
hjust = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
halign = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
colour = case_when(mean_length > 15 ~ "#FFFFFF",
TRUE ~ vit_c_palette[supplement])
),
fill = NA,
fontface = "bold",
box.colour = NA,
family = "Segoe UI") +
scale_colour_identity() +
scale_fill_manual(values = vit_c_palette) +
labs(y = "Mean length of odontobast cells",
title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>** was associated with greater mean tooth growth, compared to equivalent doses of Vitamin C"),
subtitle = "With the highest dose, the mean recorded length was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(hjust = 0.5),
text = element_text(family = "Segoe UI"),
plot.title = ggtext::element_markdown(family = "Enriqueta", size = 16, lineheight = 1.3,
margin = margin(0.5, 0, 1, 0, "lines"),
halign = 0),
plot.subtitle = ggtext::element_markdown(family = "Cabin", size = 12, lineheight = 1.3,
margin = margin(0, 0, 1, 0, "lines"),
halign = 0),
strip.text = element_text(family = "Enriqueta", face = "bold",
size = 12, margin = margin(2, 0, 0.5, 0, "lines")))
plot
plot +
theme(plot.title = ggtext::element_textbox_simple(),
plot.subtitle = ggtext::element_textbox_simple())
plot <- ToothGrowth %>%
mutate(supplement = case_when(supp == "OJ" ~ "Orange Juice",
supp == "VC" ~ "Vitamin C",
TRUE ~ as.character(supp))) %>%
group_by(supplement, dose) %>%
summarise(mean_length = mean(len)) %>%
mutate(categorical_dose = factor(dose)) %>%
ggplot(aes(x = categorical_dose,
y = mean_length,
fill = supplement)) +
geom_bar(aes(alpha = dose),
stat = "identity",
position = "dodge",
colour = "#FFFFFF", #
size = 2) + #
scale_alpha(range = c(0.33, 1)) + #
coord_flip() + #
theme_minimal() +
facet_wrap(supplement ~ ., ncol = 1) +
ggtext::geom_textbox(aes(
x = categorical_dose,
y = mean_length,
label = paste0("<span style=font-size:9pt>", dose, "mg/day</span><br>", mean_length, "mm"),
hjust = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
halign = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
colour = case_when(mean_length > 15 ~ "#FFFFFF",
TRUE ~ vit_c_palette[supplement])
),
fill = NA,
fontface = "bold",
box.colour = NA,
family = "Segoe UI") +
scale_colour_identity() +
scale_fill_manual(values = vit_c_palette) +
labs(y = "Mean length of odontobast cells",
title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>** was associated with greater mean tooth growth, compared to equivalent doses of Vitamin C"),
subtitle = "With the highest dose, the mean recorded length was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(hjust = 0.5),
text = element_text(family = "Segoe UI"),
strip.text = element_text(family = "Enriqueta", face = "bold",
size = 12, margin = margin(2, 0, 0.5, 0, "lines")))
plot +
theme(plot.title = ggtext::element_textbox_simple(),
plot.subtitle = ggtext::element_textbox_simple())
