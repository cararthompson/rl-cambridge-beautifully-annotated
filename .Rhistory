#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,
"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,
TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0,
TRUE ~ 1)),
family = "Cabin",
size = 4,
fill = NA,
box.colour = NA) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose %in% c(1, 2)),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,
"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,
TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0,
TRUE ~ 1)),
family = "Cabin",
size = 4,
fill = NA,
box.colour = NA) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose %in% c(1, 2)),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>",
guinea_pig_name,
"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,
TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0,
TRUE ~ 1)),
family = "Cabin",
size = 4,
fill = NA,
box.colour = NA) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>",
guinea_pig_name,
"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,
TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0,
TRUE ~ 1)),
family = "Cabin",
size = 4,
fill = NA,
box.colour = NA) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05, TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1, TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0, TRUE ~ 1)),
family = "Cabin", size = 4, fill = NA, box.colour = NA) +
geom_curve(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
xend = case_when(dose < 1.5 ~ dose + 0.02,
TRUE ~ dose - 0.02),
yend = case_when(min_or_max  == "max"~ len + 0.5,
TRUE ~ len - 0.5)),
curvature = 0,
arrow = arrow(length = unit(0.1, "cm")),
alpha = 0.5) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05, TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1, TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0, TRUE ~ 1)),
family = "Cabin", size = 4, fill = NA, box.colour = NA) +
geom_curve(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
xend = case_when(dose < 1.5 ~ dose + 0.02,
TRUE ~ dose - 0.02),
yend = case_when(min_or_max  == "max"~ len + 0.5,
TRUE ~ len - 0.5)),
curvature = 0.2,
arrow = arrow(length = unit(0.1, "cm")),
alpha = 0.5) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05, TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1, TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0, TRUE ~ 1)),
family = "Cabin", size = 4, fill = NA, box.colour = NA) +
geom_curve(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
xend = case_when(dose < 1.5 ~ dose + 0.02,
TRUE ~ dose - 0.02),
yend = case_when(min_or_max  == "max"~ len + 0.5,
TRUE ~ len - 0.5)),
curvature = 0.1,
arrow = arrow(length = unit(0.1, "cm")),
alpha = 0.5) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05, TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1, TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0, TRUE ~ 1)),
family = "Cabin", size = 4, fill = NA, box.colour = NA) +
geom_curve(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
xend = case_when(dose < 1.5 ~ dose + 0.02,
TRUE ~ dose - 0.02),
yend = case_when(min_or_max  == "max"~ len + 0.5,
TRUE ~ len - 0.5)),
curvature = c(0.1, 0.1, -0.1, -0.1),
arrow = arrow(length = unit(0.1, "cm")),
alpha = 0.5) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05, TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1, TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0, TRUE ~ 1)),
family = "Cabin", size = 4, fill = NA, box.colour = NA) +
geom_curve(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
xend = case_when(dose < 1.5 ~ dose + 0.02,
TRUE ~ dose - 0.02),
yend = case_when(min_or_max  == "max"~ len + 0.5,
TRUE ~ len - 0.5),
curvature = c(0.1, 0.1, -0.1, -0.1)),
#     curvature = c(0.1, 0.1, -0.1, -0.1),
arrow = arrow(length = unit(0.1, "cm")),
alpha = 0.5) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05, TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1, TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0, TRUE ~ 1)),
family = "Cabin", size = 4, fill = NA, box.colour = NA) +
geom_curve(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
xend = case_when(dose < 1.5 ~ dose + 0.02,
TRUE ~ dose - 0.02),
yend = case_when(min_or_max  == "max"~ len + 0.5,
TRUE ~ len - 0.5)),
curvature = 0.1,
arrow = arrow(length = unit(0.1, "cm")),
alpha = 0.5) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05, TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1, TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0, TRUE ~ 1)),
family = "Cabin", size = 4, fill = NA, box.colour = NA) +
geom_curve(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
xend = case_when(dose < 1.5 ~ dose + 0.02,
TRUE ~ dose - 0.02),
yend = case_when(min_or_max  == "max"~ len + 0.5,
TRUE ~ len - 0.5)),
#        curvature = 0.1,
arrow = arrow(length = unit(0.1, "cm")),
alpha = 0.5) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05, TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1, TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0, TRUE ~ 1)),
family = "Cabin", size = 4, fill = NA, box.colour = NA) +
geom_curve(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
xend = case_when(dose < 1.5 ~ dose + 0.02,
TRUE ~ dose - 0.02),
yend = case_when(min_or_max  == "max"~ len + 0.5,
TRUE ~ len - 0.5)),
curvature = 0.1,
arrow = arrow(length = unit(0.1, "cm")),
alpha = 0.5) +
scale_colour_manual(values = vit_c_palette)
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05, TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1, TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0, TRUE ~ 1)),
family = "Cabin", size = 4, fill = NA, box.colour = NA) +
geom_curve(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
xend = case_when(dose < 1.5 ~ dose + 0.02,
TRUE ~ dose - 0.02),
yend = case_when(min_or_max  == "max"~ len + 0.5,
TRUE ~ len - 0.5)),
curvature = 0,
arrow = arrow(length = unit(0.1, "cm")),
alpha = 0.5) +
scale_colour_manual(values = vit_c_palette)
carartemplates::carar_colours()
ToothGrowth %>%
mutate(supplement = case_when(supp == "OJ" ~ "Orange Juice",
supp == "VC" ~ "Vitamin C",
TRUE ~ as.character(supp))) %>%
group_by(supplement, dose) %>%
summarise(mean_length = mean(len)) %>%
mutate(categorical_dose = factor(dose)) %>%
ggplot(aes(x = categorical_dose,
y = mean_length,
fill = supplement)) +
geom_bar(aes(alpha = dose),
stat = "identity",
position = "dodge",
colour = "#FFFFFF", #
size = 2) + #
scale_alpha(range = c(0.33, 1)) + #
coord_flip() + #
theme_minimal() +
facet_wrap(supplement ~ ., ncol = 1) +
ggtext::geom_textbox(aes(
label = paste0("<span style=font-size:9pt>", dose, "mg/day</span><br>", mean_length, "mm"),
hjust = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
halign = case_when(mean_length < 15 ~ 0,
TRUE ~ 1),
colour = case_when(mean_length > 15 ~ "#FFFFFF",
TRUE ~ vit_c_palette[supplement])),
fill = NA,
fontface = "bold",
box.colour = NA,
family = "Cabin") +
scale_colour_identity() +
scale_fill_manual(values = vit_c_palette) +
labs(y = "Mean length of odontobast cells (mm)",
title = paste0("In smaller doses, **<span style='color:",
vit_c_palette["Orange Juice"], "'>Orange Juice</span>**
was associated with greater mean tooth growth,
compared to equivalent doses of **<span style='color:",
vit_c_palette["Vitamin C"], "'>Vitamin C</span>**"),
subtitle = "With the highest dose, the mean recorded length was almost identical.") +
scale_x_discrete(breaks = c("0.5", "1", "2"), labels = function(x) paste0(x, " mg/day")) +
scale_y_continuous(expand = c(0, 0.5)) +
theme(legend.position = "none",
axis.title.y = element_blank(),
axis.title.x = element_text(face = "bold"),
text = element_text(family = "Cabin", colour = vit_c_palette["light_text"]),
plot.title = ggtext::element_textbox_simple(family = "Enriqueta", size = 16, lineheight = 1.3,
margin = margin(0.5, 0, 1, 0, "lines"),
face = "bold",
halign = 0, colour = vit_c_palette["dark_text"]),
plot.subtitle = ggtext::element_textbox_simple(family = "Cabin", size = 12, lineheight = 1.3,
margin = margin(0, 0, 1, 0, "lines"),
halign = 0),
strip.text = element_text(family = "Enriqueta", face = "bold",
hjust = 0.03,
size = 12, margin = margin(2, 0, 0, 0, "lines"),
colour = vit_c_palette["light_text"]),
panel.grid = element_blank())
annotated_scatter_plot +
theme(panel.grid = element_line(colour = "#F0F0F0"))
annotated_scatter_plot <- themed_scatter_plot +
geomtextpath::geom_textline(stat = "smooth", aes(label = supplement),
hjust = 0.1,
vjust = 0.3,
fontface = "bold",
family = "Cabin") +
ggtext::geom_textbox(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05, TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1, TRUE ~ len * 0.9),
label = paste0("**<span style='font-family:Enriqueta'>", guinea_pig_name,"</span>** - ", len, " mm"),
hjust = case_when(dose < 1.5 ~ 0,TRUE ~ 1),
halign = case_when(dose < 1.5 ~ 0, TRUE ~ 1)),
family = "Cabin", size = 4, fill = NA, box.colour = NA) +
geom_curve(data = filter(min_max_gps,
dose == 2),
aes(x = case_when(dose < 1.5 ~ dose + 0.05,
TRUE ~ dose - 0.05),
y = case_when(min_or_max  == "max"~ len * 1.1,
TRUE ~ len * 0.9),
xend = case_when(dose < 1.5 ~ dose + 0.02,
TRUE ~ dose - 0.02),
yend = case_when(min_or_max  == "max"~ len + 0.5,
TRUE ~ len - 0.5)),
curvature = 0,
arrow = arrow(length = unit(0.1, "cm")),
alpha = 0.5) +
scale_colour_manual(values = vit_c_palette)
annotated_scatter_plot
annotated_scatter_plot +
theme(panel.grid = element_line(colour = "#F0F0F0"))
annotated_scatter_plot +
theme(panel.grid = element_line(colour = "#F0F0F0"))
annotated_scatter_plot +
theme(panel.grid = element_line(colour = "#F0F0F0"))
annotated_scatter_plot
annotated_scatter_plot +
theme(panel.grid = element_line(colour = "#F0F0F0"))
monochromeR::generate_palette(vit_c_palette["light_text"], "go_lighter", n_colours = 2)
monochromeR::generate_palette(vit_c_palette["light_text"], "go_lighter", n_colours = 2, view_palette = T)
monochromeR::view_palette(c("#F0F0F0", "#D6D7D5"))
monochromeR::generate_palette("#D6D7D5", "go_lighter", n_colours = 2, view_palette = T)
annotated_scatter_plot +
theme(panel.grid = element_line(colour = "#F6F7F6"))
annotated_scatter_plot
annotated_scatter_plot +
theme(panel.grid = element_line(colour = "#F6F7F6"))
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
annotated_scatter_plot +
theme(panel.grid = element_line(colour = "#F6F7F6"),
plot.margin = margin(6, 6, 6, 6))
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
annotated_scatter_plot +
theme(panel.grid = element_line(colour = "#F6F7F6"),
plot.margin = margin(12, 8, 12, 8))
annotated_scatter_plot
#| output-location: column-fragment
#| echo: true
#| code-line-numbers: "2-7"
annotated_scatter_plot +
theme(panel.grid = element_line(colour = "#F6F7F6"),
plot.margin = margin(12, 8, 12, 8))
